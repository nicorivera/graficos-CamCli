let iso3 = {
  países: [
    {
      codigo: "AFG",
      nombre: "Afganistán",
    },
    {
      codigo: "ALB",
      nombre: "Albania",
    },
    {
      codigo: "ATA",
      nombre: "Antártida",
    },
    {
      codigo: "DZA",
      nombre: "Argelia",
    },
    {
      codigo: "ASM",
      nombre: "Samoa americana",
    },
    {
      codigo: "AND",
      nombre: "Andorra",
    },
    {
      codigo: "AGO",
      nombre: "Angola",
    },
    {
      codigo: "ATG",
      nombre: "Antigua y Barbuda",
    },
    {
      codigo: "AZE",
      nombre: "Azerbaiyán",
    },
    {
      codigo: "ARG",
      nombre: "Argentina",
    },
    {
      codigo: "AUS",
      nombre: "Australia",
    },
    {
      codigo: "AUT",
      nombre: "Austria",
    },
    {
      codigo: "BHS",
      nombre: "Bahamas",
    },
    {
      codigo: "BHR",
      nombre: "Bahrein",
    },
    {
      codigo: "BGD",
      nombre: "Bangladesh",
    },
    {
      codigo: "ARM",
      nombre: "Armenia",
    },
    {
      codigo: "BRB",
      nombre: "Barbados",
    },
    {
      codigo: "BEL",
      nombre: "Bélgica",
    },
    {
      codigo: "BMU",
      nombre: "Bermudas",
    },
    {
      codigo: "BTN",
      nombre: "Bhután",
    },
    {
      codigo: "BOL",
      nombre: "Bolivia",
    },
    {
      codigo: "BIH",
      nombre: "Bosnia-Herzegovina",
    },
    {
      codigo: "BWA",
      nombre: "Botswana",
    },
    {
      codigo: "BVT",
      nombre: "Bouvet, Isla",
    },
    {
      codigo: "BRA",
      nombre: "Brasil",
    },
    {
      codigo: "BLZ",
      nombre: "Belice",
    },
    {
      codigo: "IOT",
      nombre: "Océano Índico, Territorio británico del",
    },
    {
      codigo: "SLB",
      nombre: "Salomón, Islas",
    },
    {
      codigo: "VGB",
      nombre: "Vírgenes británicas, Islas",
    },
    {
      codigo: "BRN",
      nombre: "Brunei Darussalam",
    },
    {
      codigo: "BGR",
      nombre: "Bulgaria",
    },
    {
      codigo: "MMR",
      nombre: "Myanmar",
    },
    {
      codigo: "BDI",
      nombre: "Burundi",
    },
    {
      codigo: "BLR",
      nombre: "Belarus",
    },
    {
      codigo: "KHM",
      nombre: "Camboya",
    },
    {
      codigo: "CMR",
      nombre: "Camerún",
    },
    {
      codigo: "CAN",
      nombre: "Canadá",
    },
    {
      codigo: "CPV",
      nombre: "Cabo Verde",
    },
    {
      codigo: "CYM",
      nombre: "Caimán, Islas",
    },
    {
      codigo: "CAF",
      nombre: "Centroafricana, República",
    },
    {
      codigo: "LKA",
      nombre: "Sri Lanka",
    },
    {
      codigo: "TCD",
      nombre: "Chad",
    },
    {
      codigo: "CHL",
      nombre: "Chile",
    },
    {
      codigo: "CHN",
      nombre: "China",
    },
    {
      codigo: "TWN",
      nombre: "Taiwan, Provincia de China",
    },
    {
      codigo: "CXR",
      nombre: "Christmas, isla",
    },
    {
      codigo: "CCK",
      nombre: "Cocos (Keeling), islas",
    },
    {
      codigo: "COL",
      nombre: "Colombia",
    },
    {
      codigo: "COM",
      nombre: "Comores",
    },
    {
      codigo: "MYT",
      nombre: "Mayotte",
    },
    {
      codigo: "COG",
      nombre: "Congo",
    },
    {
      codigo: "COD",
      nombre: "Congo, República democrática del",
    },
    {
      codigo: "COK",
      nombre: "Cook, Islas",
    },
    {
      codigo: "CRI",
      nombre: "Costa Rica",
    },
    {
      codigo: "HRV",
      nombre: "Croacia",
    },
    {
      codigo: "CUB",
      nombre: "Cuba",
    },
    {
      codigo: "CYP",
      nombre: "Chipre",
    },
    {
      codigo: "CZE",
      nombre: "República Checa",
    },
    {
      codigo: "BEN",
      nombre: "Benín",
    },
    {
      codigo: "DNK",
      nombre: "Dinamarca",
    },
    {
      codigo: "DMA",
      nombre: "Dominica",
    },
    {
      codigo: "DOM",
      nombre: "República Dominicana",
    },
    {
      codigo: "ECU",
      nombre: "Ecuador",
    },
    {
      codigo: "SLV",
      nombre: "El Salvador",
    },
    {
      codigo: "GNQ",
      nombre: "Guinea ecuatorial",
    },
    {
      codigo: "ETH",
      nombre: "Etiopía",
    },
    {
      codigo: "ERI",
      nombre: "Eritrea",
    },
    {
      codigo: "EST",
      nombre: "Estonia",
    },
    {
      codigo: "FRO",
      nombre: "Feroe, Islas",
    },
    {
      codigo: "FLK",
      nombre: "Falkland (Malvinas), Islas",
    },
    {
      codigo: "SGS",
      nombre: "Georgia del Sur e Islas Sandwich del Sur",
    },
    {
      codigo: "FJI",
      nombre: "Fiji",
    },
    {
      codigo: "FIN",
      nombre: "Finlandia",
    },
    {
      codigo: "ALA",
      nombre: "Åland, Islas",
    },
    {
      codigo: "FRA",
      nombre: "Francia",
    },
    {
      codigo: "GUF",
      nombre: "Guyana francesa",
    },
    {
      codigo: "PYF",
      nombre: "Polinesia francesa",
    },
    {
      codigo: "ATF",
      nombre: "Territorios Australes franceses",
    },
    {
      codigo: "DJI",
      nombre: "Djibouti",
    },
    {
      codigo: "GAB",
      nombre: "Gabón",
    },
    {
      codigo: "GEO",
      nombre: "Georgia",
    },
    {
      codigo: "GMB",
      nombre: "Gambia",
    },
    {
      codigo: "PSE",
      nombre: "Palestina, Territorio ocupado de",
    },
    {
      codigo: "DEU",
      nombre: "Alemania",
    },
    {
      codigo: "GHA",
      nombre: "Ghana",
    },
    {
      codigo: "GIB",
      nombre: "Gibraltar",
    },
    {
      codigo: "KIR",
      nombre: "Kiribati",
    },
    {
      codigo: "GRC",
      nombre: "Grecia",
    },
    {
      codigo: "GRL",
      nombre: "Groenlandia",
    },
    {
      codigo: "GRD",
      nombre: "Granada",
    },
    {
      codigo: "GLP",
      nombre: "Guadalupe",
    },
    {
      codigo: "GUM",
      nombre: "Guam",
    },
    {
      codigo: "GTM",
      nombre: "Guatemala",
    },
    {
      codigo: "GIN",
      nombre: "Guinea",
    },
    {
      codigo: "GUY",
      nombre: "Guayana",
    },
    {
      codigo: "HTI",
      nombre: "Haití",
    },
    {
      codigo: "HMD",
      nombre: "Heard y McDonald, Islas",
    },
    {
      codigo: "VAT",
      nombre: "Santa Sede (Estado de la Ciudad del Vaticano)",
    },
    {
      codigo: "HND",
      nombre: "Honduras",
    },
    {
      codigo: "HKG",
      nombre: "Hong-Kong",
    },
    {
      codigo: "HUN",
      nombre: "Hungría",
    },
    {
      codigo: "ISL",
      nombre: "Islandia",
    },
    {
      codigo: "IND",
      nombre: "India",
    },
    {
      codigo: "IDN",
      nombre: "Indonesia",
    },
    {
      codigo: "IRN",
      nombre: "Irán, República islámica de",
    },
    {
      codigo: "IRQ",
      nombre: "Iraq",
    },
    {
      codigo: "IRL",
      nombre: "Irlanda",
    },
    {
      codigo: "ISR",
      nombre: "Israel",
    },
    {
      codigo: "ITA",
      nombre: "Italia",
    },
    {
      codigo: "CIV",
      nombre: "Costa de Marfil",
    },
    {
      codigo: "JAM",
      nombre: "Jamaica",
    },
    {
      codigo: "JPN",
      nombre: "Japón",
    },
    {
      codigo: "KAZ",
      nombre: "Kazajstán",
    },
    {
      codigo: "JOR",
      nombre: "Jordania",
    },
    {
      codigo: "KEN",
      nombre: "Kenia",
    },
    {
      codigo: "PRK",
      nombre: "Corea, República popular democrática de",
    },
    {
      codigo: "KOR",
      nombre: "Corea, República de",
    },
    {
      codigo: "KWT",
      nombre: "Kuwait",
    },
    {
      codigo: "KGZ",
      nombre: "Kirguistán",
    },
    {
      codigo: "LAO",
      nombre: "Laos, República democrática popular de",
    },
    {
      codigo: "LBN",
      nombre: "Líbano",
    },
    {
      codigo: "LSO",
      nombre: "Lesotho",
    },
    {
      codigo: "LVA",
      nombre: "Letonia",
    },
    {
      codigo: "LBR",
      nombre: "Liberia",
    },
    {
      codigo: "LBY",
      nombre: "Libia, Jamahiriya árabe",
    },
    {
      codigo: "LIE",
      nombre: "Liechtenstein",
    },
    {
      codigo: "LTU",
      nombre: "Lituania",
    },
    {
      codigo: "LUX",
      nombre: "Luxemburgo",
    },
    {
      codigo: "MAC",
      nombre: "Macao",
    },
    {
      codigo: "MDG",
      nombre: "Madagascar",
    },
    {
      codigo: "MWI",
      nombre: "Malawi",
    },
    {
      codigo: "MYS",
      nombre: "Malasia",
    },
    {
      codigo: "MDV",
      nombre: "Maldivas",
    },
    {
      codigo: "MLI",
      nombre: "Mali",
    },
    {
      codigo: "MLT",
      nombre: "Malta",
    },
    {
      codigo: "MTQ",
      nombre: "Martinica",
    },
    {
      codigo: "MRT",
      nombre: "Mauritania",
    },
    {
      codigo: "MUS",
      nombre: "Mauricio",
    },
    {
      codigo: "MEX",
      nombre: "Méjico",
    },
    {
      codigo: "MCO",
      nombre: "Mónaco",
    },
    {
      codigo: "MNG",
      nombre: "Mongolia",
    },
    {
      codigo: "MDA",
      nombre: "Moldavia, República de Moldova",
    },
    {
      codigo: "MNE",
      nombre: "Montenegro",
    },
    {
      codigo: "MSR",
      nombre: "Montserrat",
    },
    {
      codigo: "MAR",
      nombre: "Marruecos",
    },
    {
      codigo: "MOZ",
      nombre: "Mozambique",
    },
    {
      codigo: "OMN",
      nombre: "Omán",
    },
    {
      codigo: "NAM",
      nombre: "Namibia",
    },
    {
      codigo: "NRU",
      nombre: "Nauru",
    },
    {
      codigo: "NPL",
      nombre: "Nepal",
    },
    {
      codigo: "NLD",
      nombre: "Países Bajos",
    },
    {
      codigo: "CUW",
      nombre: "Curazao",
    },
    {
      codigo: "ABW",
      nombre: "Aruba",
    },
    {
      codigo: "SXM",
      nombre: "San Martín (parte holandesa)",
    },
    {
      codigo: "BES",
      nombre: "Bonaire, San Eustaquio y Saba",
    },
    {
      codigo: "NCL",
      nombre: "Nueva Caledonia",
    },
    {
      codigo: "VUT",
      nombre: "Vanuatu",
    },
    {
      codigo: "NZL",
      nombre: "Nueva Zelanda",
    },
    {
      codigo: "NIC",
      nombre: "Nicaragua",
    },
    {
      codigo: "NER",
      nombre: "Níger",
    },
    {
      codigo: "NGA",
      nombre: "Nigeria",
    },
    {
      codigo: "NIU",
      nombre: "Niué",
    },
    {
      codigo: "NFK",
      nombre: "Norfolk, Isla",
    },
    {
      codigo: "NOR",
      nombre: "Noruega",
    },
    {
      codigo: "MNP",
      nombre: "Marianas del Norte, Islas",
    },
    {
      codigo: "UMI",
      nombre: "Ultramarinas de los Estados Unidos, Islas",
    },
    {
      codigo: "FSM",
      nombre: "Micronesia, Estados federados de",
    },
    {
      codigo: "MHL",
      nombre: "Marshall, Islas",
    },
    {
      codigo: "PLW",
      nombre: "Palau",
    },
    {
      codigo: "PAK",
      nombre: "Pakistán",
    },
    {
      codigo: "PAN",
      nombre: "Panamá",
    },
    {
      codigo: "PNG",
      nombre: "Papúa Nueva Guinea",
    },
    {
      codigo: "PRY",
      nombre: "Paraguay",
    },
    {
      codigo: "PER",
      nombre: "Perú",
    },
    {
      codigo: "PHL",
      nombre: "Filipinas",
    },
    {
      codigo: "PCN",
      nombre: "Pitcairn",
    },
    {
      codigo: "POL",
      nombre: "Polonia",
    },
    {
      codigo: "PRT",
      nombre: "Portugal",
    },
    {
      codigo: "GNB",
      nombre: "Guinea-Bissau",
    },
    {
      codigo: "TLS",
      nombre: "Timor oriental",
    },
    {
      codigo: "PRI",
      nombre: "Puerto Rico",
    },
    {
      codigo: "QAT",
      nombre: "Qatar",
    },
    {
      codigo: "REU",
      nombre: "Reunión",
    },
    {
      codigo: "ROU",
      nombre: "Rumanía",
    },
    {
      codigo: "RUS",
      nombre: "Federación Rusa",
    },
    {
      codigo: "RWA",
      nombre: "Ruanda",
    },
    {
      codigo: "BLM",
      nombre: "San Bartolomé",
    },
    {
      codigo: "SHN",
      nombre: "Santa Helena",
    },
    {
      codigo: "KNA",
      nombre: "San Cristóbal y Nieves",
    },
    {
      codigo: "AIA",
      nombre: "Anguila",
    },
    {
      codigo: "LCA",
      nombre: "Santa Lucía",
    },
    {
      codigo: "MAF",
      nombre: "San Martín (parte francesa)",
    },
    {
      codigo: "SPM",
      nombre: "San Pedro y Miquelón",
    },
    {
      codigo: "VCT",
      nombre: "San Vicente y Granadinas",
    },
    {
      codigo: "SMR",
      nombre: "San Marino",
    },
    {
      codigo: "STP",
      nombre: "Santo Tomé y Príncipe",
    },
    {
      codigo: "SAU",
      nombre: "Arabia Saudí",
    },
    {
      codigo: "SEN",
      nombre: "Senegal",
    },
    {
      codigo: "SRB",
      nombre: "Serbia",
    },
    {
      codigo: "SYC",
      nombre: "Seychelles",
    },
    {
      codigo: "SLE",
      nombre: "Sierra Leona",
    },
    {
      codigo: "SGP",
      nombre: "Singapur",
    },
    {
      codigo: "SVK",
      nombre: "Eslovaquia",
    },
    {
      codigo: "VNM",
      nombre: "Vietnam",
    },
    {
      codigo: "SVN",
      nombre: "Eslovenia",
    },
    {
      codigo: "SOM",
      nombre: "Somalia",
    },
    {
      codigo: "ZAF",
      nombre: "Sudáfrica",
    },
    {
      codigo: "ZWE",
      nombre: "Zimbabwe",
    },
    {
      codigo: "ESP",
      nombre: "España",
    },
    {
      codigo: "SSD",
      nombre: "Sudán del Sur",
    },
    {
      codigo: "SDN",
      nombre: "Sudán",
    },
    {
      codigo: "ESH",
      nombre: "Sahara occidental",
    },
    {
      codigo: "SUR",
      nombre: "Suriname",
    },
    {
      codigo: "SJM",
      nombre: "Svalbard e isla Jan Mayen",
    },
    {
      codigo: "SWZ",
      nombre: "Swazilandia",
    },
    {
      codigo: "SWE",
      nombre: "Suecia",
    },
    {
      codigo: "CHE",
      nombre: "Suiza",
    },
    {
      codigo: "SYR",
      nombre: "Siria, República árabe",
    },
    {
      codigo: "TJK",
      nombre: "Tayikistán",
    },
    {
      codigo: "THA",
      nombre: "Tailandia",
    },
    {
      codigo: "TGO",
      nombre: "Togo",
    },
    {
      codigo: "TKL",
      nombre: "Tokelau",
    },
    {
      codigo: "TON",
      nombre: "Tonga",
    },
    {
      codigo: "TTO",
      nombre: "Trinidad y Tobago",
    },
    {
      codigo: "ARE",
      nombre: "Emiratos árabes unidos",
    },
    {
      codigo: "TUN",
      nombre: "Túnez",
    },
    {
      codigo: "TUR",
      nombre: "Turquía",
    },
    {
      codigo: "TKM",
      nombre: "Turkmenistán",
    },
    {
      codigo: "TCA",
      nombre: "Turcos y Caicos, Islas",
    },
    {
      codigo: "TUV",
      nombre: "Tuvalu",
    },
    {
      codigo: "UGA",
      nombre: "Uganda",
    },
    {
      codigo: "UKR",
      nombre: "Ucrania",
    },
    {
      codigo: "MKD",
      nombre: "Macedonia, antigua república yugoslava de",
    },
    {
      codigo: "EGY",
      nombre: "Egipto",
    },
    {
      codigo: "GBR",
      nombre: "Reino Unido",
    },
    {
      codigo: "GGY",
      nombre: "Guernsey",
    },
    {
      codigo: "JEY",
      nombre: "Jersey",
    },
    {
      codigo: "IMN",
      nombre: "Man, Isla de",
    },
    {
      codigo: "TZA",
      nombre: "Tanzania, República unida de",
    },
    {
      codigo: "USA",
      nombre: "Estados Unidos",
    },
    {
      codigo: "VIR",
      nombre: "Vírgenes (USA), Islas",
    },
    {
      codigo: "BFA",
      nombre: "Burkina Faso",
    },
    {
      codigo: "URY",
      nombre: "Uruguay",
    },
    {
      codigo: "UZB",
      nombre: "Uzbekistán",
    },
    {
      codigo: "VEN",
      nombre: "Venezuela",
    },
    {
      codigo: "WLF",
      nombre: "Wallis y Futuna",
    },
    {
      codigo: "WSM",
      nombre: "Samoa",
    },
    {
      codigo: "YEM",
      nombre: "Yemen",
    },
    {
      codigo: "ZMB",
      nombre: "Zambia",
    },
    {
      codigo: "OWID_WRL",
      nombre: "Mundo",
    },
  ],
};

function obtenerNombrePorCodigo(codigo) {
  const país = iso3.países.find((p) => p.codigo === codigo);
  if (país) {
    return país.nombre;
  } else {
    return "Código no encontrado";
  }
}

function load_data() {
  return new Promise((resolve, reject) => {
    Papa.parse("./data/data.csv", {
      download: true,
      header: true,
      complete: function (results) {
        const data = results.data.map((fila) => {
          if (fila.anio) {
            fila.year = new Date(parseInt(fila.anio), 0, 1).getTime();
            delete fila.anio;
          }
          if (fila.valor_en_porcentaje) {
            fila.value = parseFloat(fila.valor_en_porcentaje);
            delete fila.valor_en_porcentaje;
          }
          if (fila.iso3) {
            fila.category = obtenerNombrePorCodigo(fila.iso3);
            delete fila.iso3;
          }
          return fila;
        });
        console.log("Datos analizados:", data);
        resolve(data);
      },
      error: function (error) {
        console.error("Error al cargar o analizar el archivo:", error);
        reject(error);
      },
    });
  });
}
